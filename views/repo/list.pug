extends ../layout

block content
  h2 Your repositories
  hr

  div.row
    div.col-md-3
      .row
        .col-md-12
          div.organizations
            a(href=`/repositories/${user.github_login}`, class= user.github_login == current_org ? 'active' : '')
              img(src=user.profile.picture)
              span.name #{user.github_login}

            for o in organizations
              a(href='/repositories/' + o.name, class= o.name == current_org ? 'active' : '')
                img(src=o.avatar_url)
                span.name #{o.name}

      .row
        .col-md-3
          form(action='/sync/organizations', method='POST')
            input(type='hidden', name='_csrf', value=_csrf)
            button.btn.btn-link
              i.fa.fa-refresh
              | synchronize your organizations

    if repositories
      div.col-md-9
        ul.repositories
          for r in repositories
            li.repository
              div.name
                | #{r.name}
                if r.enabled
                  | &nbsp;
                  span.label.label-success ENABLED
                else if r.github_hook_id
                  | &nbsp;
                  span.label.label-default PAUSED
              div.actions
                if r.enabled
                  form(action=`/repositories/${current_org}/${r.name}/pause`, method='POST')
                    input(type='hidden', name='_csrf', value=_csrf)
                    button.btn
                      i.fa.fa-pause-circle-o
                      | pause
                else
                  form(action=`/repositories/${current_org}/${r.name}/enable`, method='POST')
                    input(type='hidden', name='_csrf', value=_csrf)
                    button.btn.btn-success
                      i.fa.fa-play-circle-o
                      if r.github_hook_id
                        | restart
                      else
                        | start

        form(action=`/sync/repositories/${current_org}`, method='POST')
          input(type='hidden', name='_csrf', value=_csrf)
          button.btn.btn-link
            i.fa.fa-refresh
            | synchronize #{current_org}'s repositories
